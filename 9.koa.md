## KOA

express：基于回调的思想

express可以直接加get、post；server.get().......自带路由

koa:利用promise的思想，消除了异步操作

koa不带路由

koa版本：

+ v1 generator
+ v2 过渡版  generator/async,await
+ v3  async/await

`npm i koa -D`

```javascript
const koa=require('koa')
let server=new koa()

server.listen(8080)
```

###koa中间件

#### koa-router

`npm i koa-router -D`

+ let router=new Router();
+ router.get('/a',async  ctx=>{ctx.body='aaa';})
+ server.use(router.routes())
  + get/post/use=>all (use在koa里面主要作用是加中间件)

```javascript
const koa=require('koa')
const Router=require('koa-router')

let server=new koa()
server.listen(8080)

let router=new Router();

router.get('/a',async ctx=>{
    ctx.body='aaa';

})
//router.get('/a',async (ctx,next)=>{})
//此时路由并没有挂载到服务器上
server.use(router.routes())
```

#####路由嵌套

```powershell
/user
	/company
	/admin
/news
/cart
```

```javascript
const koa=require('koa')
const Router=require('koa-router')

let server=new koa()
server.listen(8080)

let router=new Router();
let userRouter=new Router();
    let companyRouter=new Router();
    companyRouter.get('/c',async ctx=>{
        ctx.body='compang de a'
    })
    let admainRouter=new Router();
    admainRouter.get('/c',async ctx=>{
        ctx.body='admain de a'
    })
userRouter.get('/',async ctx=>{
    ctx.body='user'
})
userRouter.use('/company',companyRouter.routes())
userRouter.use('/admain',admainRouter.routes())

router.use('/user',userRouter.routes());

// router.get('/a',async ctx=>{
//     ctx.body='aaa';

// })
//router.get('/a',async (ctx,next)=>{})
//此时路由并没有挂载到服务器上
server.use(router.routes())
```

一般项目中会将嵌套路由分来来写，具体见

##### 路由参数

一般：http://www.sohu.com/news/2222

router.get('/news/**:id**/', async ctx=>{
  **let {id}=ctx.params;**

  ctx.body+='aaa';
});

```javascript
const Koa=require('koa');
const Router=require('koa-router');

let server=new Koa();
server.listen(8080);

//
let router=new Router();


router.get('/news/:id/', async (ctx, next)=>{
  let {id}=ctx.params;

  ctx.body='bbb';

  await next();//要调用下一级，必须使用await；下一级是个async函数
    //不使用await next（），则不会执行下一级，自上而下执行
});
router.get('/news/1/', async ctx=>{
  let {id}=ctx.params;

  ctx.body+='aaa';//bbbaaa,前后均赋值则会覆盖
});

server.use(router.routes());

```

问题：用?id=xxx传参和/:id有什么区别？倾向于用/:id吗？





